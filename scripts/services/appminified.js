angular.module("courier").service("locationHistoryService",function(){return{previousLocation:null,store:function(a){this.previousLocation=a},get:function(){return this.previousLocation}}}).run(["$rootScope","locationHistoryService",function(a,b){a.$on("$locationChangeSuccess",function(a,c,d){b.store(d)})}]),angular.module("courier").service("ValiDatedTokenObject",function(){var a={},b=function(){return a},c=function(b){a=angular.copy(b)};return{getValiDatedTokenObject:b,setValiDatedTokenObject:c}}),angular.module("courier").factory("AuthService",["$http","$q","ValiDatedTokenObject","RESOURCES",function(a,b,c,d){var e=d.API_BASE_PATH,f={},g={isAuth:!1,userName:"",isUser:!1,isAdministrator:!1,UserId:"",isActive:!1},h={provider:"",userName:"",externalAccessToken:"",email:"",firstName:"",lastName:""},i=function(){var a=sessionStorage.getItem("reference_friend_ids"),b=[];return null!=a&&(b=JSON.parse(a),null==b&&(b=[])),b},j=function(){sessionStorage.removeItem("reference_friend_ids")},k=function(){var b={};b.referenceIds=i(),g.isUser&&b.referenceIds.length>0?a.post(e+"tracking/references",b,{headers:{"Content-Type":"application/json",Authorization:c.getValiDatedTokenObject().token_type+" "+c.getValiDatedTokenObject().access_token}}).then(function(a){return j(),a}):j()},l=function(){var a=sessionStorage.getItem("referrals"),b=[];return null!=a&&(b=JSON.parse(a),null==b&&(b=[])),b},m=function(){sessionStorage.removeItem("referrals")},n=function(){var b={};b.referralIds=l(),g.isUser&&b.referralIds.length>0?a.post(e+"tracking/referrals",b,{headers:{"Content-Type":"application/json",Authorization:c.getValiDatedTokenObject().token_type+" "+c.getValiDatedTokenObject().access_token}}).then(function(a){return m(),a}):m()},o=function(d){s();var f=b.defer();return a.post(e+"api/registeruser",d).then(function(a){return"success"==a.data.status?(c.setValiDatedTokenObject(a.data.response),sessionStorage.setItem("ValiDatedTokenObject",JSON.stringify(c.getValiDatedTokenObject())),g.isAuth=!0,g.userName=a.data.response[0].name,g.isUser=2==parseInt(a.data.response[0].role_id),g.isAdministrator=1==parseInt(a.data.response[0].role_id),g.UserId=a.data.response[0].id,g.isActive=!1,sessionStorage.setItem("UserId",a.data.response[0].id),f.resolve(a),a):(f.resolve(a),a)})},p=function(c){b.defer();return a.post(e+"api/verifyuser",c).then(function(a){return a})},q=function(c){b.defer();return a.post(e+"api/sendinvite",c).then(function(a){return a})},r=function(d){var f=b.defer();return a({method:"POST",url:e+"api/getloginuser",data:{email:d.userName,password:d.password},headers:{"Content-Type":"application/json"}}).success(function(a){"success"==a.status?(c.setValiDatedTokenObject(a.response),sessionStorage.setItem("ValiDatedTokenObject",JSON.stringify(c.getValiDatedTokenObject())),g.isAuth=!0,g.userName=a.response[0].name,g.isUser=2==parseInt(a.response[0].role_id),g.isAdministrator=1==parseInt(a.response[0].role_id),g.UserId=a.response[0].id,g.isActive="Y"==a.response[0].status,sessionStorage.setItem("UserId",a.response[0].id),f.resolve(a)):f.resolve(a)}).error(function(a){s(),f.reject(err)}),f.promise},s=function(){sessionStorage.removeItem("ValiDatedTokenObject"),g.isAuth=!1,g.userName="",g.isUser=!1,g.isAdministrator=!1,g.UserId="",g.isActive=!1,sessionStorage.removeItem("UserId")},t=function(){var a=sessionStorage.getItem("ValiDatedTokenObject");a&&(c.setValiDatedTokenObject(JSON.parse(a)),a=c.getValiDatedTokenObject(),g.isAuth=!0,g.isUser=2==parseInt(a[0].role_id),g.isAdministrator=1==parseInt(a[0].role_id),g.UserId=a[0].id,g.isActive="Y"==a[0].status,sessionStorage.setItem("UserId",a[0].id),g.userName=a[0].name)},u=function(d){var f=b.defer();return a.get(e+"account/ObtainLocalAccessToken",{params:{provider:d.provider,externalAccessToken:d.externalAccessToken}}).success(function(a){var b="User"==a.roles,d="Admin"==a.roles;a.isUser=b,a.isAdministrator=d,c.setValiDatedTokenObject(a),sessionStorage.setItem("ValiDatedTokenObject",JSON.stringify(c.getValiDatedTokenObject())),g.isAuth=!0,g.userName=a.userName,g.isUser=b,g.isAdministrator=d,n(),k(),f.resolve(a)}).error(function(a,b){s(),f.reject(a)}),f.promise},v=function(b){return a.get(e+"api/getuserdetails/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},w=function(b){return a.get(e+"api/getunreadchannellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},x=function(b){return a.get(e+"api/getuserslist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},y=function(b){return a.get(e+"api/getchannelmessageslist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},z=function(b){return a.post(e+"account/resetpasswordtoken",b).then(function(a){return a})},A=function(b){return a.post(e+"api/forgetpassword",b).then(function(a){return a})},B=function(b){return a.post(e+"api/updateuserdetails",b).then(function(a){return a})},C=function(b){return a.post(e+"api/changepassword",b).then(function(a){return a})};return f.saveRegistration=o,f.login=r,f.logOut=s,f.fillAuthData=t,f.authentication=g,f.obtainAccessToken=u,f.externalAuthData=h,f.getuserdetails=v,f.getchannelslist=w,f.getuserslist=x,f.getchatlist=y,f.resetPasswordToken=z,f.resetPassword=A,f.changepassword=C,f.updateuserdetails=B,f.verifyuser=p,f.inviteuser=q,f}]),angular.module("courier").factory("searchService",["$http","$q","RESOURCES","ValiDatedTokenObject",function(a,b,c,d){d.setValiDatedTokenObject(JSON.parse(sessionStorage.getItem("ValiDatedTokenObject")));var e=c.API_BASE_PATH,f={},g=function(b,c,d,f,g){if(params={},"undefined"!=typeof b&&""!==b&&null!=b){var h=new Date(b);params.dateFrom=moment(h).format("YYYY/MM/DD")}else params.dateFrom="";if("undefined"!=typeof c&&""!==c&&null!=c){var h=new Date(c);params.dateTo=moment(h).format("YYYY/MM/DD")}else params.dateTo="";return"undefined"!=typeof d&&""!==d&&null!=d?params.locationfrom=d:params.locationfrom="","undefined"!=typeof f&&""!==f&&null!=f?params.locationto=f:params.locationto="","undefined"!=typeof g&&""!==g&&null!=g?params.type=g:params.type="Transporter",a.post(e+"api/searchhome",{headers:{"Content-Type":"application/json"},params:params}).then(function(a){return a})},h=function(b){return a.get(e+"api/gettransporterdetail/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},i=function(b,c,d){return params={},"undefined"!=typeof b&&""!==b&&null!=b?params.mobile=b:params.mobile="","undefined"!=typeof c&&""!==c&&null!=c?params.email=c:params.email="",params.UserId=d,a.post(e+"api/searchuser",{headers:{"Content-Type":"application/json"},params:params}).then(function(a){return a})},j=function(b){return a.post(e+"api/createpaymentrequest",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},k=function(b){return a.get(e+"api/paymentrequestlist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})};return f.searchuser=i,f.searchAdvanced=g,f.gettransporterdetails=h,f.paymentrequestlist=k,f.createpaymentrequest=j,f}]),angular.module("courier").factory("AddTripsService",["$http","$q","RESOURCES","ValiDatedTokenObject",function(a,b,c,d){d.setValiDatedTokenObject(JSON.parse(sessionStorage.getItem("ValiDatedTokenObject")));var e=c.API_BASE_PATH,f={},g=function(b){return a.post(e+"api/addtrip",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},h=function(b){return a.post(e+"api/updatetrip",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},i=function(b){return a.post(e+"api/updatetripticket",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},j=function(b){return a.post(e+"api/cancelparcelbytransporter",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},k=function(b){return a.post(e+"api/updatetripstatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},l=function(b){return a.post(e+"api/usrupdatetripstatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},m=function(b){return a.post(e+"api/deletesingletrip",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},n=function(b){return a.get(e+"api/triplist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},o=function(b,c){return a.get(e+"api/senderbookingrequest/"+b+"/"+c,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},p=function(){return a.get(e+"api/triplistall/",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},q=function(b){return a.get(e+"api/canceltripslist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})};return f.AddTripsData=g,f.updateticketTripsData=i,f.updateTripsData=h,f.getTripsList=n,f.getTripsListall=p,f.getcalcelledTripsList=q,f.updatestatus=k,f.cancelparcelbytransporter=j,f.usrupdatestatus=l,f.deletetrip=m,f.senderbookingrequest=o,f}]),angular.module("courier").factory("ParcelService",["$http","$q","RESOURCES","ValiDatedTokenObject",function(a,b,c,d){d.setValiDatedTokenObject(JSON.parse(sessionStorage.getItem("ValiDatedTokenObject")));var e=c.API_BASE_PATH,f={},g=function(b){return a.post(e+"api/addparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},h=function(b){return a.post(e+"api/calculateamount",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},i=function(b){return a.post(e+"api/addcontacts",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},j=function(b){return a.post(e+"api/updateparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},k=function(b){return a.post(e+"api/updateparcelweight",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},l=function(b){return a.post(e+"api/updateParceltatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},m=function(b){return a.post(e+"api/usrupdateParceltatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},n=function(b){return a.post(e+"api/generateordernumber",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},o=function(b){return a.post(e+"api/deletesingleparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},p=function(b){return a.get(e+"api/parcellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},q=function(b){return a.post(e+"api/parcellistall",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},r=function(b){return a.post(e+"api/allbookinglist",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},s=function(){return a.get(e+"api/contactslist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},t=function(b){return a.get(e+"api/cancelparcellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},u=function(b){return a.get(e+"api/getwalletstatement/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},v=function(b){return a.get(e+"api/refundedparcellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},w=function(b){return a.get(e+"api/getparceldetail/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})};return f.addcontacts=i,f.AddParcelData=g,f.calculateamount=h,f.updateParcelData=j,f.updateparcelweight=k,f.getParcelList=p,f.getParcelListall=q,f.getallbookinglist=r,f.contactslist=s,f.getcalcelledParcelList=t,f.getrefundedParcelList=v,f.getwalletstatement=u,f.updatestatus=l,f.usrupdatestatus=m,f.deletetrip=o,f.getparceldetail=w,f.generateordernumber=n,f}]),angular.module("courier").factory("AirportService",["$http","$q","RESOURCES","ValiDatedTokenObject",function(a,b,c,d){d.setValiDatedTokenObject(JSON.parse(sessionStorage.getItem("ValiDatedTokenObject")));var e=c.API_BASE_PATH,f={},g=function(){return a.get(e+"api/getcountries",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},h=function(){return a.get(e+"api/getzonelist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},i=function(){return a.get(e+"api/getseolist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},j=function(){return a.get(e+"api/getweightrangelist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},k=function(b){return a.post(e+"api/savezonepricelist",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return console.log(a),a})},l=function(b){return a.post(e+"api/saveairportlist",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return console.log(a),a})},m=function(b){return a.post(e+"api/saveseolist",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return console.log(a),a})},n=function(b){return a.get(e+"api/deleteairportlist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},o=function(b){return a.get(e+"api/deleteseolist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},p=function(){return a.get(e+"api/getzonepricelist",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},q=function(b){return a.get(e+"api/deleteairportlist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})};return f.getzonelist=h,f.getseolist=i,f.getweightrangelist=j,f.getairportslist=g,f.saveairportdate=l,f.saveseolist=m,f.savezonepricelist=k,f.deleteairportlist=n,f.deleteseolist=o,f.getpricelist=p,f.deletepricelist=q,f}]),angular.module("courier").factory("ReceiverService",["$http","$q","RESOURCES","ValiDatedTokenObject",function(a,b,c,d){d.setValiDatedTokenObject(JSON.parse(sessionStorage.getItem("ValiDatedTokenObject")));var e=c.API_BASE_PATH,f={},g=function(b){return a.post(e+"api/addparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},h=function(b){return a.post(e+"api/updateparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},i=function(b){return a.post(e+"api/updateParceltatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},j=function(b){return a.post(e+"api/chatsubmit",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},k=function(b){return a.post(e+"api/usrupdateParceltatus",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},l=function(b){return a.post(e+"api/generateordernumber",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},m=function(b){return a.post(e+"api/deletesingleparcel",b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},n=function(b){return a.get(e+"api/receiverlist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},o=function(){return a.get(e+"api/parcellistall/",{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},p=function(b){return a.get(e+"api/cancelparcellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},q=function(b){return a.get(e+"api/refundedparcellist/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})},r=function(b){return a.get(e+"api/getparceldetail/"+b,{headers:{"Content-Type":"application/json"}}).then(function(a){return a})};return f.AddParcelData=g,f.updateParcelData=h,f.getreceiverlist=n,f.getParcelListall=o,f.getcalcelledParcelList=p,f.getrefundedParcelList=q,f.updatestatus=i,f.submitchat=j,f.usrupdatestatus=k,f.deletetrip=m,f.getparceldetail=r,f.generateordernumber=l,f}]);